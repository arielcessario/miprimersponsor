(function(){angular.module("miPrimerSponsor",["oc.lazyLoad","ngRoute","ngAnimate","angular-storage","angular-jwt","duScroll","auth0","acUtils","acUsuarios","acProyectos","acUploads","acProgressBar","acContacts","acAnimate"]).config(["$routeProvider","authProvider",function(c,d){d.init({domain:"ac-desarrollos.auth0.com",clientID:"su5JUmdUk52EWhfK5xxZJtnw6W3IK9c1",loginUrl:"/ingreso"});c.otherwise("/main");c.when("/main",{templateUrl:"main/main.html",controller:"MainController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("main/main.js")}]}});c.when("/administracion",{templateUrl:"administracion/administracion.html",controller:"AdministracionController",data:{requiresLogin:true},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("administracion/administracion.js")}]}});c.when("/nuevo_usuario",{templateUrl:"nuevo_usuario/nuevo_usuario.html",controller:"NuevoUsuarioController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("nuevo_usuario/nuevo_usuario.js")}]}});c.when("/ingreso",{templateUrl:"ingreso/ingreso.html",controller:"IngresoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("ingreso/ingreso.js")}]}});c.when("/proyecto/:id",{templateUrl:"proyecto/proyecto.html",controller:"ProyectoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("proyecto/proyecto.js")}]}});c.when("/resultados",{templateUrl:"resultados/resultados.html",controller:"ResultadoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("resultados/resultados.js")}]}})}]).run(function(c,d,f,g,e){e.hookEvents();c.$on("$routeChangeStart",function(h,i){if(i&&i.data&&i.data.requiresLogin){if(!d.get(window.appName)){h.preventDefault();g.path("/ingreso")}}})}).controller("AppController",a).service("AppService",b);a.$inject=["UserService","$location","AppService","CategoryService","$timeout","$document","$scope","DonationService","AcUtils","ContactsService","ProyectService"];function a(k,e,g,c,q,t,l,p,i,h,s){var o=this;o.hideLoader=true;o.menu_mobile_open=false;o.user=k.getFromToken();o.isLogged=false;o.welcomeTo="";o.categorias=[];o.textProyecto="";o.proyecto={};o.logout=n;o.goToAnchor=j;o.filterByCategory=m;o.filterByText=d;o.donacionRapida=f;o.goToDetalle=r;if(o.user!=false){o.isLogged=true;o.welcomeTo=o.user.data.nombre}c.get(function(u){o.categorias=u});function r(v,u){g.origen=u;e.path("/proyecto/"+v)}g.listen(function(){o.user=k.getFromToken();if(o.user!=false){o.isLogged=true;o.welcomeTo=o.user.data.nombre}else{e.path("/ingreso");o.isLogged=false;o.welcomeTo="";o.user=false}});function j(u){e.path("/main");q(function(){var v=1000;var x=50;var w=angular.element(document.getElementById(u));t.scrollToElement(w,x,v)},20)}l.$watch("appCtrl.textProyecto",function(v,u){if(v!=u&&v!=undefined&&!g.vieneDeCat){d()}});function d(){g.type="t";g.search=o.textProyecto;e.path("/resultados");q(function(){o.textProyecto=""},1000)}function m(u){g.vieneDeCat=true;g.type="c";g.search=u;o.textProyecto="";e.path("/resultados");g.broadcastCategoria()}function n(){k.logout(function(u){e.path("/ingreso");o.isLogged=false;o.welcomeTo="";o.user=false})}function f(v,w,x){if(!o.user){i.showMessage("error","Debe estar registrado e ingresado para poder realizar una donación.");e.path("/ingreso");return}if(isNaN(v)&&v.indexOf("searchDon")>-1){v=parseFloat(document.getElementById(v).value)}if(v<0||isNaN(v)){i.showMessage("error","La donación debe ser mayor a 0");v=0;return}var u={proyecto_id:w,donador_id:o.user.data.id,valor:v,status:0};p.create(u,function(y){if(y>0){i.showMessage("success","Donación realizada con éxito, por favor aguarde la confirmación de la misma.");s.getByParams("proyecto_id",""+w,"true",function(z){h.sendMail(o.user.data.mail,[{mail:"arielcessario@gmail.com"},{mail:"mmaneff@gmail.com"}],"MPE","Existe un nuevo cambio para aprobar","NUEVA DONACIÓN - Proyecto "+((o.proyecto.nombre==undefined)?x:o.proyecto.nombre),function(A){console.log(A)});h.sendMail(o.user.data.mail,[{mail:o.user.data.mail}],"MPE","Su donación ha sido realizada, por favor realice la transferencia correspondiente y espere a su aprobación.","NUEVA DONACIÓN - Proyecto "+((o.proyecto.nombre==undefined)?x:o.proyecto.nombre),function(A){console.log(A)})})}else{i.showMessage("error","Hubo un problema con la donación, por favor contacte al administrador")}})}}b.$inject=["$rootScope"];function b(c){this.vieneDeCat=false;this.search="";this.type="c";this.origen="/main";this.listen=function(d){c.$on("miprimersponsorradio",d)};this.broadcast=function(){c.$broadcast("miprimersponsorradio")};this.listenCategoria=function(d){c.$on("miprimersponsorradiocategoria",d)};this.broadcastCategoria=function(){c.$broadcast("miprimersponsorradiocategoria")}}})();WebFontConfig={google:{families:["Droid+Sans:400,700:latin"]}};(function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";a.type="text/javascript";a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();