(function(){angular.module("miPrimerSponsor",["oc.lazyLoad","ngRoute","ngAnimate","angular-storage","angular-jwt","duScroll","auth0","acUtils","acUsuarios","acProyectos","acUploads","acProgressBar","acContacts","acAnimate"]).config(["$routeProvider","authProvider",function(c,d){d.init({domain:"ac-desarrollos.auth0.com",clientID:"su5JUmdUk52EWhfK5xxZJtnw6W3IK9c1",loginUrl:"/ingreso"});c.otherwise("/main");c.when("/main",{templateUrl:"main/main.html",controller:"MainController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("main/main.js")}]}});c.when("/administracion",{templateUrl:"administracion/administracion.html",controller:"AdministracionController",data:{requiresLogin:true},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("administracion/administracion.js")}]}});c.when("/nuevo_usuario",{templateUrl:"nuevo_usuario/nuevo_usuario.html",controller:"NuevoUsuarioController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("nuevo_usuario/nuevo_usuario.js")}]}});c.when("/ingreso",{templateUrl:"ingreso/ingreso.html",controller:"IngresoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("ingreso/ingreso.js")}]}});c.when("/proyecto/:id",{templateUrl:"proyecto/proyecto.html",controller:"ProyectoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("proyecto/proyecto.js")}]}});c.when("/resultados",{templateUrl:"resultados/resultados.html",controller:"ResultadoController",data:{requiresLogin:false},resolve:{loadMyCtrl:["$ocLazyLoad",function(e){return e.load("resultados/resultados.js")}]}})}]).run(function(c,d,f,g,e){e.hookEvents();c.$on("$routeChangeStart",function(h,i){if(i&&i.data&&i.data.requiresLogin){if(!d.get(window.appName)){h.preventDefault();g.path("/ingreso")}}})}).controller("AppController",a).service("AppService",b);a.$inject=["UserService","$location","AppService","CategoryService","$timeout","$document","$scope","DonationService","AcUtils","ContactsService","ProyectService"];function a(m,l,k,h,e,j,q,i,g,p,o){var d=this;d.hideLoader=true;d.menu_mobile_open=false;d.user=m.getFromToken();d.isLogged=false;d.welcomeTo="";d.categorias=[];d.textProyecto="";d.proyecto={};d.logout=s;d.goToAnchor=c;d.filterByCategory=n;d.filterByText=r;d.donacionRapida=f;if(d.user!=false){d.isLogged=true;d.welcomeTo=d.user.data.nombre}h.get(function(t){d.categorias=t});k.listen(function(){d.user=m.getFromToken();if(d.user!=false){d.isLogged=true;d.welcomeTo=d.user.data.nombre}else{l.path("/ingreso");d.isLogged=false;d.welcomeTo="";d.user=false}});function c(t){l.path("/main");e(function(){var u=1000;var w=50;var v=angular.element(document.getElementById(t));j.scrollToElement(v,w,u)},20)}q.$watch("appCtrl.textProyecto",function(u,t){if(u!=t&&u!=undefined&&!k.vieneDeCat){r()}if(u==""&&!k.vieneDeCat){l.path("/main")}else{k.vieneDeCat=false}});function r(){k.search=d.textProyecto;k.type="t";k.search=d.textProyecto;l.path("/resultados")}function n(t){k.vieneDeCat=true;k.type="c";k.search=t;d.textProyecto="";l.path("/resultados");k.broadcast()}function s(){m.logout(function(t){l.path("/ingreso");d.isLogged=false;d.welcomeTo="";d.user=false})}function f(u,v){if(!d.user){l.path("/ingreso");return}if(u<0||isNaN(u)){g.showMessage("error","La donación debe ser mayor a 0");u=0;return}var t={proyecto_id:v,donador_id:d.user.data.id,valor:u,status:0};i.create(t,function(w){if(w>0){g.showMessage("success","Donación realizada con éxito, por favor aguarde la confirmación de la misma.");o.getByParams("proyecto_id",""+v,"true",function(x){p.sendMail(d.user.data.mail,[{mail:"arielcessario@gmail.com"},{mail:"mmaneff@gmail.com"}],"MPE","Existe un nuevo cambio para aprobar","NUEVA DONACIÓN - Proyecto "+d.proyecto.nombre,function(y){console.log(y)});p.sendMail(d.user.data.mail,[{mail:d.user.data.mail}],"MPE","Su donación ha sido realizada, por favor realice la transferencia correspondiente y espere a su aprobación.","NUEVA DONACIÓN - Proyecto "+d.proyecto.nombre,function(y){console.log(y)})})}else{g.showMessage("error","Hubo un problema con la donación, por favor contacte al administrador")}})}}b.$inject=["$rootScope"];function b(c){this.vieneDeCat=false;this.search="";this.type="c";this.listen=function(d){c.$on("miprimersponsorradio",d)};this.broadcast=function(){c.$broadcast("miprimersponsorradio")}}})();WebFontConfig={google:{families:["Droid+Sans:400,700:latin"]}};(function(){var a=document.createElement("script");a.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js";a.type="text/javascript";a.async="true";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();