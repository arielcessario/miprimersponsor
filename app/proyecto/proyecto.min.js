(function(){var a=document.getElementsByTagName("script");var c=a[a.length-1].src;angular.module("miprimersponsor.proyecto",["ngRoute"]).controller("ProyectoController",b);b.$inject=["UserService","DonationService","ProyectService","$routeParams","CommentService","AcUtils","$location"];function b(j,f,k,l,n,g,i){var d=this;d.proyectos=[];d.proyecto={};d.donacion_cantidad=0;d.id=l.id;d.user=j.getFromToken();d.comentario={};d.comentarios=[];d.donacionRapida=e;d.comentar=m;d.back=h;k.getByParams("proyecto_id",""+d.id,"true",function(o){d.proyecto=o[0];d.proyecto=angular.copy(o[0]);d.proyecto.porc=Math.round(d.proyecto.total_donado*100/d.proyecto.costo_inicial);d.proyecto.faltan=(new Date(new Date(d.proyecto.fecha_fin)-new Date())).getDate();n.get(d.proyecto.proyecto_id,function(p){d.comentarios=p})});function e(p,q){if(!d.user){i.path("/ingreso");return}var o={proyecto_id:q,donador_id:d.user.data.id,valor:p,status:0};f.create(o,function(r){console.log(r)})}function m(){if(d.user.data.id==undefined){alert("Debe estar registrado para poder realizar comentarios");return}if(d.comentario.detalles==undefined||d.comentario.detalles.trim()==""){g.validations("proyecto-comentario-nuevo","El comentario no debe estar vac√≠o");return}d.comentario.proyecto_id=d.proyecto.proyecto_id;d.comentario.titulo="";d.comentario.parent_id=0;d.comentario.creador_id=d.user.data.id;d.comentario.votos_up=0;d.comentario.votos_down=0;n.create(d.comentario,function(o){n.get(d.proyecto.proyecto_id,function(p){d.comentario.detalles="";d.comentarios=p})})}function h(){i.path("/main")}}})();