(function(){var a=document.getElementsByTagName("script");var c=a[a.length-1].src;angular.module("miprimersponsor.proyecto",["ngRoute"]).controller("ProyectoController",b);b.$inject=["UserService","DonationService","ProyectService","$routeParams","CommentService","AcUtils","$location","ContactsService","AppService"];function b(j,e,k,m,o,f,i,l,g){var d=this;d.proyectos=[];d.proyecto={};d.donacion_cantidad=0;d.id=m.id;d.user=j.getFromToken();d.comentario={};d.comentarios=[];d.donacion_rapida_valor=0;d.comentar=n;d.back=h;k.getByParams("proyecto_id",""+d.id,"true",function(p){d.proyecto=p[0];d.proyecto=angular.copy(p[0]);d.proyecto.porc=Math.round(d.proyecto.total_donado*100/d.proyecto.costo_inicial);d.proyecto.faltan=(new Date(new Date(d.proyecto.fecha_fin)-new Date())).getDate();o.get(d.proyecto.proyecto_id,function(q){d.comentarios=q})});function n(){if(!d.user||d.user.data.id==undefined){f.showMessage("erro","Debe estar registrado para poder realizar comentarios");return}if(d.comentario.detalles==undefined||d.comentario.detalles.trim()==""){f.validations("proyecto-comentario-nuevo","El comentario no debe estar vac√≠o");return}d.comentario.proyecto_id=d.proyecto.proyecto_id;d.comentario.titulo="";d.comentario.parent_id=0;d.comentario.creador_id=d.user.data.id;d.comentario.votos_up=0;d.comentario.votos_down=0;o.create(d.comentario,function(p){o.get(d.proyecto.proyecto_id,function(q){d.comentario.detalles="";d.comentarios=q})})}function h(){i.path(g.origen)}}})();