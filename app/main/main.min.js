(function(){var a=document.getElementsByTagName("script");var c=a[a.length-1].src;angular.module("miprimersponsor.main",["ngRoute",["administracion/administracion.min.js"]]).controller("MainController",b);b.$inject=["UserService","DonationService","ProyectService","$location","AdministracionService","$interval","ProyectVars","ContactsService"];function b(j,f,l,h,i,k,e,m){var d=this;d.proyectos=[];d.proyecto={};d.user=j.getFromToken();d.donacion_rapida_valor=10;d.slider_nro=1;d.proyectos_slider=[];d.proyecto_slider_01={};d.proyecto_slider_02={};d.proyecto_slider_03={};d.proyecto_slider_04={};d.proyecto_nuevo_01={};d.proyecto_nuevo_02={};d.proyecto_nuevo_03={};d.proyecto_finalizar_01={};d.proyecto_finalizar_02={};d.proyecto_finalizar_03={};d.email="";d.nombre="";d.mensaje="";d.asunto="";d.enviado=false;d.enviando=false;d.goToCrear=n;d.sendMail=o;e.activos=true;e.clearCache=true;l.get(function(p){l.getByParams("en_slider","1","true",function(q){d.proyecto_slider_01=q[0];d.proyecto_slider_02=q[1];d.proyecto_slider_03=q[2];d.proyecto_slider_04=q[3]});p.sort(function(r,q){return new Date(q.fecha_inicio)-new Date(r.fecha_inicio)});d.proyecto_nuevo_01=angular.copy(p[0]);d.proyecto_nuevo_01.porc=Math.round(d.proyecto_nuevo_01.total_donado*100/d.proyecto_nuevo_01.costo_inicial);d.proyecto_nuevo_01.faltan=(new Date(new Date(d.proyecto_nuevo_01.fecha_fin)-new Date())).getDate();d.proyecto_nuevo_02=p[1];d.proyecto_nuevo_02.porc=Math.round(d.proyecto_nuevo_02.total_donado*100/d.proyecto_nuevo_02.costo_inicial);d.proyecto_nuevo_02.faltan=(new Date(new Date(d.proyecto_nuevo_02.fecha_fin)-new Date())).getDate();d.proyecto_nuevo_03=p[2];d.proyecto_nuevo_03.porc=Math.round(d.proyecto_nuevo_03.total_donado*100/d.proyecto_nuevo_03.costo_inicial);d.proyecto_nuevo_03.faltan=(new Date(new Date(d.proyecto_nuevo_03.fecha_fin)-new Date())).getDate();p.sort(function(r,q){return new Date(r.fecha_fin)-new Date(q.fecha_fin)});d.proyecto_finalizar_01=p[0];d.proyecto_finalizar_01.porc=Math.round(d.proyecto_finalizar_01.total_donado*100/d.proyecto_finalizar_01.costo_inicial);d.proyecto_finalizar_01.faltan=(new Date(new Date(d.proyecto_finalizar_01.fecha_fin)-new Date())).getDate();d.proyecto_finalizar_02=p[1];d.proyecto_finalizar_02.porc=Math.round(d.proyecto_finalizar_02.total_donado*100/d.proyecto_finalizar_02.costo_inicial);d.proyecto_finalizar_02.faltan=(new Date(new Date(d.proyecto_finalizar_02.fecha_fin)-new Date())).getDate();d.proyecto_finalizar_03=p[2];d.proyecto_finalizar_03.porc=Math.round(d.proyecto_finalizar_03.total_donado*100/d.proyecto_finalizar_03.costo_inicial);d.proyecto_finalizar_03.faltan=(new Date(new Date(d.proyecto_finalizar_03.fecha_fin)-new Date())).getDate()});k(g,3000);function g(){d.slider_nro=(d.slider_nro==4)?1:d.slider_nro+1}function n(){i.screen="administracion/proyectos.html";h.path("/administracion")}function o(){if(d.enviando){return}d.enviando=true;m.sendMail(d.email,[{mail:"arielcessario@gmail.com"}],d.nombre,d.mensaje,d.asunto,function(q,p){d.enviando=false;console.log(q);console.log(p);d.email="";d.nombre="";d.asunto="";d.mensaje=""})}}})();